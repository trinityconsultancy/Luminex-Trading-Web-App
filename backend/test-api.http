### Luminex Trading Backend API Testing
### Use this file with REST Client extension in VS Code or similar tools

@baseUrl = http://localhost:5000
@apiUrl = {{baseUrl}}/api/auth

### Health Check
GET {{baseUrl}}/health

### 1. Register New User
POST {{apiUrl}}/register
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john.doe@example.com",
  "phone": "+919876543210",
  "password": "SecurePass@123",
  "confirmPassword": "SecurePass@123"
}

### 2. Send OTP (Email) - For registration verification
POST {{apiUrl}}/send-otp
Content-Type: application/json

{
  "type": "email",
  "purpose": "registration",
  "contact": "john.doe@example.com",
  "userId": "USER_ID_FROM_REGISTRATION"
}

### 3. Send OTP (SMS) - For registration verification
POST {{apiUrl}}/send-otp
Content-Type: application/json

{
  "type": "sms",
  "purpose": "registration",
  "contact": "+919876543210",
  "userId": "USER_ID_FROM_REGISTRATION"
}

### 4. Verify Email OTP
POST {{apiUrl}}/verify-otp
Content-Type: application/json

{
  "otp": "123456",
  "type": "email",
  "purpose": "registration",
  "userId": "USER_ID_FROM_REGISTRATION"
}

### 5. Verify SMS OTP (Completes registration)
POST {{apiUrl}}/verify-otp
Content-Type: application/json

{
  "otp": "654321",
  "type": "sms",
  "purpose": "registration",
  "userId": "USER_ID_FROM_REGISTRATION"
}

### 6. Login - Step 1 (Send OTP)
POST {{apiUrl}}/login
Content-Type: application/json

{
  "identifier": "john.doe@example.com",
  "password": "SecurePass@123",
  "otpType": "email"
}

### 7. Login - Step 2 (Verify OTP and get tokens)
POST {{apiUrl}}/login-verify
Content-Type: application/json

{
  "otp": "123456",
  "type": "email",
  "userId": "USER_ID_FROM_LOGIN"
}

### 8. Get Current User Profile
GET {{apiUrl}}/me
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE

### 9. Refresh Access Token
POST {{apiUrl}}/refresh-token
Content-Type: application/json

{
  "refreshToken": "YOUR_REFRESH_TOKEN_HERE"
}

### 10. Forgot Password - Send OTP
POST {{apiUrl}}/forgot-password
Content-Type: application/json

{
  "identifier": "john.doe@example.com",
  "otpType": "email"
}

### 11. Reset Password with OTP
POST {{apiUrl}}/reset-password
Content-Type: application/json

{
  "identifier": "john.doe@example.com",
  "otp": "123456",
  "otpType": "email",
  "newPassword": "NewSecurePass@123"
}

### 12. Change Password (Authenticated)
POST {{apiUrl}}/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "SecurePass@123",
  "newPassword": "NewSecurePass@456",
  "confirmPassword": "NewSecurePass@456"
}

### 13. Logout
POST {{apiUrl}}/logout
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "refreshToken": "YOUR_REFRESH_TOKEN_HERE"
}

### 14. Login with Phone Number
POST {{apiUrl}}/login
Content-Type: application/json

{
  "identifier": "+919876543210",
  "password": "SecurePass@123",
  "otpType": "sms"
}

### 15. Admin Login (Default admin account)
POST {{apiUrl}}/login
Content-Type: application/json

{
  "identifier": "admin@luminex.com",
  "password": "Admin@123456",
  "otpType": "email"
}

### Error Testing

### Invalid Registration - Missing fields
POST {{apiUrl}}/register
Content-Type: application/json

{
  "name": "John",
  "email": "invalid-email"
}

### Invalid Login - Wrong credentials
POST {{apiUrl}}/login
Content-Type: application/json

{
  "identifier": "nonexistent@example.com",
  "password": "wrongpassword"
}

### Invalid OTP Verification
POST {{apiUrl}}/verify-otp
Content-Type: application/json

{
  "otp": "000000",
  "type": "email",
  "purpose": "registration",
  "userId": "invalid-user-id"
}

### Rate Limiting Test - Multiple rapid requests
POST {{apiUrl}}/login
Content-Type: application/json

{
  "identifier": "test@example.com",
  "password": "wrongpassword"
}

### Unauthorized Access Test
GET {{apiUrl}}/me

### Invalid Token Test
GET {{apiUrl}}/me
Authorization: Bearer invalid.token.here

### Test Variables for Easy Switching
# @testEmail = test@luminex.com
# @testPhone = +919999999999
# @testPassword = TestPass@123
# @adminEmail = admin@luminex.com
# @adminPassword = Admin@123456
